webpackJsonp([64],{IVcU:function(t,s){},WL24:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var e=i("mvHQ"),n=i.n(e),o=i("Au9i"),a={data:function(){return{rxId:this.$route.query.rxId,shopId:this.$route.query.shopId,shopName:this.$route.query.shopName,type:this.$route.query.type,drugs:[],show:!1,origins:[],index:0,carts:[],isActive:!0,amount:0,quantity:0}},computed:{account:function(){return this.$store.getters.account}},created:function(){this.getDrugs()},mounted:function(){this.$refs.content.style.height=document.documentElement.clientHeight-this.$refs.header.$el.clientHeight-this.$refs.footer.$el.clientHeight+"px",this.$refs.content.style.overflow="auto"},methods:{getDrugs:function(){var t=this;this.$http.get("/rxs/"+this.rxId+"/shops/"+this.shopId+"/drugs").then(function(s){console.log(s.data),t.drugs=s.data,t.initCart()}).catch(function(s){t.exception(s)})},lookMore:function(t){this.origins=this.drugs[t].drugs,this.index=t,this.show=!0,this.isActive=!this.isActive},takeUp:function(){this.show=!this.show,this.isActive=!this.isActive},initCart:function(){var t=this;this.drugs.forEach(function(s){t.carts.push({accountId:t.account.id,shopId:t.shopId,rxId:t.rxId,drugSpecId:s.drugs[0].drugSpecId,shopDrugSpecId:s.drugs[0].shopDrugSpecId,name:s.name,spec:s.spec,price:s.drugs[0].price,quantity:s.quantity,fileId:s.drugs[0].fileId,otc:s.otc,originName:s.drugs[0].originName,rxItemId:s.rxItemId})}),this.carts.forEach(function(s){t.amount+=s.price*s.quantity,t.quantity+=s.quantity})},choose:function(t){var s=this,i=this.carts[this.index];i.drugSpecId=this.origins[t].drugSpecId,i.shopDrugSpecId=this.origins[t].shopDrugSpecId,i.price=this.origins[t].price,i.fileId=this.origins[t].fileId,i.originName=this.origins[t].originName,this.amount=0,this.carts.forEach(function(t){s.amount+=t.price*t.quantity,s.quantity+=t.quantity}),this.show=!this.show,this.isActive=!this.isActive},createCart:function(){var t=this;this.$http.post("/carts",this.carts).then(function(t){Object(o.Toast)({message:"加入购物车成功",position:"middle",duration:2e3})}).catch(function(s){t.exception(s)})},onBuy:function(){var t=this,s={rxId:this.rxId,shopId:this.shopId,shopName:this.shopName,type:this.type,orderShopDrugSpecInfoDTOList:this.carts};this.$http.post("orders/shop/get",s).then(function(i){t.$router.push("/orders/create/fromShop?orderShopDrugSpecDTO="+n()(s))}).catch(function(s){t.exception(s)})}}},r={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"rx"},[i("van-nav-bar",{ref:"header",attrs:{title:t.$route.name,"left-arrow":""},on:{"click-left":function(s){t.$router.go(-1)}}}),t._v(" "),i("van-popup",{model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[i("div",{staticClass:"rx__popup"},[i("div",{staticClass:"rx__popup__header van-hairline--bottom"},[i("div",{staticClass:"rx__popup__header__left"},[i("van-icon",{attrs:{name:"changshangbaojia",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",[t._v("选择厂商")])],1),t._v(" "),i("div",{staticClass:"rx__popup__header__right"},[i("van-icon",{attrs:{name:"arrowdown",color:"#13C1FE",size:"3em"}})],1)]),t._v(" "),i("div",{staticClass:"rx__popup__content"},[i("div",{staticClass:"rx__popup__content__header van-hairline--bottom"},[i("div",{staticClass:"rx__popup__content__header__left"},[i("van-icon",{attrs:{name:"changfang",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",[t._v("厂商名称")])],1),t._v(" "),i("div",{staticClass:"rx__popup__content__header__right"},[i("van-icon",{attrs:{name:"jiage",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",[t._v("价格")])],1)]),t._v(" "),t._l(t.origins,function(s,e){return i("div",{key:e,staticClass:"rx__popup__content__item van-hairline--bottom",on:{click:function(s){t.choose(e)}}},[i("span",[t._v("\n            "+t._s(s.originName)+"\n          ")]),t._v(" "),i("span",[t._v("\n            ¥"+t._s(s.price)+"\n          ")])])})],2)])]),t._v(" "),i("div",{ref:"content",staticClass:"rx__content"},[t._l(t.drugs,function(s,e){return i("div",{key:e,staticClass:"rx__content__item"},[i("div",{staticClass:"rx__content__item__left"},[t.carts[e].otc?t._e():i("div",{staticClass:"rx_mark"},[t._v("处")]),t._v(" "),i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.getImgURL(t.carts[e].fileId,"LARGE_LOGO"),expression:"getImgURL(carts[index].fileId, 'LARGE_LOGO')"}],staticClass:"rx__content__item__left-logo"})]),t._v(" "),i("div",{staticClass:"rx__content__item__right"},[i("div",{staticClass:"rx__content__item__right-originName",on:{click:function(s){t.lookMore(e)}}},[i("van-icon",{attrs:{name:"changfang",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",[t._v("厂商")]),t._v(" "),i("span",[t._v(t._s(t.carts[e].originName))]),t._v(" "),i("van-icon",{attrs:{name:"arrow",size:"2em"}})],1),t._v(" "),i("div",{staticClass:"rx__content__item__right-name"},[i("van-icon",{attrs:{name:"yao",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",[t._v("名称")]),t._v(" "),i("span",[t._v(t._s(t.carts[e].name))])],1),t._v(" "),i("div",{staticClass:"rx__content__item__right-spec"},[i("van-icon",{attrs:{name:"yaopinshuju",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",[t._v("规格")]),t._v(" "),i("span",[t._v(t._s(t.carts[e].spec))])],1),t._v(" "),i("div",{staticClass:"rx__content__item__right-price"},[i("van-icon",{attrs:{name:"qian",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",[t._v("最低价")]),t._v(" "),i("span",[t._v("¥"+t._s(t.carts[e].price))]),t._v(" "),i("span",[t._v("X"+t._s(t.carts[e].quantity))])],1)])])}),t._v(" "),i("div",{staticClass:"rx__content__total"},[i("van-icon",{attrs:{name:"qian",color:"#13C1FE",size:"3em"}}),t._v(" "),i("span",{staticClass:"ml-l-20"},[t._v("总计"+t._s(t.quantity)+"件商品")]),t._v(" "),i("span",{staticClass:"ml-l-20"},[t._v("合计")]),t._v(" "),i("span",{staticClass:"ml-l-20"},[t._v("¥"+t._s(t.toFixedTwo(t.amount)))])],1)],2),t._v(" "),i("van-goods-action",{ref:"footer"},[i("van-goods-action-mini-btn",{attrs:{icon:"cart",text:"购物车",to:"/carts"}}),t._v(" "),i("van-goods-action-mini-btn",{attrs:{icon:"shop",text:"店铺",to:{path:"/shops/view",query:{shopId:t.shopId}}}}),t._v(" "),i("van-goods-action-big-btn",{style:{backgroundColor:"HOSPITAL"===t.type?"gray":"#f85"},attrs:{text:"加入购物车"},on:{click:function(s){"HOSPITAL"!==t.type&&t.createCart()}}}),t._v(" "),i("van-goods-action-big-btn",{attrs:{text:"立即购买",primary:""},on:{click:t.onBuy}})],1)],1)},staticRenderFns:[]};var c=i("VU/8")(a,r,!1,function(t){i("IVcU")},null,null);s.default=c.exports}});