webpackJsonp([79],{JyoW:function(e,t){},X2Qw:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("Dd8w"),n=s.n(i),a=s("NYxO"),o={name:"createFromCart",data:function(){return{name:"订单结算",account:this.$store.getters.account,orderShopDrugSpecDTO:JSON.parse(this.$route.query.orderShopDrugSpecDTO),shopDrugSpecOrderDTO:{},deliveryType:this.$storage.get("deliveryType")||"SELF",payType:"KRCB",couponRecord:"",coupons:[],show:!1,payAmount:0,loading:!1}},components:{},computed:n()({},Object(a.b)(["receiveAddress"])),created:function(){console.log(this.orderShopDrugSpecDTO),this.getData()},mounted:function(){this.$refs.content.style.height=document.documentElement.clientHeight-this.$refs.header.$el.clientHeight-this.$refs.footer.$el.clientHeight+"px",this.$refs.content.style.overflow="auto"},methods:n()({getData:function(){var e=this;this.isBlank(this.receiveAddress)&&this.$http.get("addresses/default").then(function(t){e.isNotBlank(t.data)&&e.setReceiveAddress(t.data)}).catch(function(t){e.exception(t)}),this.$http.post("orders/shop/get",this.orderShopDrugSpecDTO).then(function(t){e.shopDrugSpecOrderDTO=t.data,console.log(t.data),e.payAmount=t.data.payAmount,e.$http.get("couponRecords/order").then(function(s){e.coupons=s.data.filter(function(e){return t.data.payAmount>=e.amount})}).catch(function(t){e.exception(t)})}).catch(function(t){e.exception(t)})},onOrder:function(){var e=this;this.loading=!0;var t={};switch(this.deliveryType){case"DELIVERY":if(this.isBlank(this.receiveAddress))return void this.$toast("请维护收货地址");t.addressId=this.receiveAddress.id}t.orderShopDrugSpecDTO=this.orderShopDrugSpecDTO,t.deliveryType=this.deliveryType,t.payType=this.payType,t.couponRecordId=this.couponRecord.id,this.$http.post("/orders/shop",t).then(function(t){console.log(t.data),e.$router.replace({path:"/orders/pay?orderIds="+t.data+"&deliveryType="+e.deliveryType})}).catch(function(t){e.loading=!1,e.exception(t)})},onDeliveryType:function(e){this.deliveryType=e,this.$storage.set("deliveryType",e)},onPayType:function(e){this.payType=e}},Object(a.c)({setReceiveAddress:"SET_RECEIVE_ADDRESS"}))},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"pay_shop"},[s("van-nav-bar",{ref:"header",attrs:{title:e.$route.name,"left-arrow":""},on:{"click-left":function(t){e.$router.go(-1)}}}),e._v(" "),s("div",{ref:"content",staticClass:"pay_shop-content"},["DELIVERY"===e.deliveryType?s("div",{staticClass:"pay_shop-content-delivery",on:{click:e.linkToOrderAddress}},[e.isNotBlank(e.receiveAddress)?s("div",{staticClass:"pay_shop-content-delivery-address"},[e._m(0),e._v(" "),s("div",{staticClass:"pay_shop-content-delivery-address-center"},[s("div",{staticClass:"elps"},[s("span",[e._v("收货人:"+e._s(e.receiveAddress.consignee))]),e._v(" "),s("span",{staticClass:"ml-l-10"},[e._v(e._s(e.receiveAddress.phone))])]),e._v(" "),s("div",{staticClass:"elps"},[e._v("\n            收货地址:"+e._s(e.receiveAddress.address)+"\n          ")])]),e._v(" "),e._m(1)]):s("div",{staticClass:"pay_shop-content-delivery-no_address"},[e._v("\n        请维护地址>\n      ")]),e._v(" "),e._m(2)]):e._e(),e._v(" "),s("new-close-shop",{attrs:{shopInfo:e.shopDrugSpecOrderDTO}}),e._v(" "),s("div",{staticClass:"pay_shop-content-delivery_type"},[e._m(3),e._v(" "),s("div",{staticClass:"pay_shop-content-delivery_type-content"},["SIMPLE"===e.shopDrugSpecOrderDTO.type?s("span",{class:{active:"DELIVERY"==e.deliveryType},on:{click:function(t){t.stopPropagation(),e.onDeliveryType("DELIVERY")}}},[e._v("\n          送货\n        ")]):e._e(),e._v(" "),s("span",{class:{active:"SELF"==e.deliveryType},on:{click:function(t){t.stopPropagation(),e.onDeliveryType("SELF")}}},[e._v("上门自提")])])]),e._v(" "),s("div",{staticClass:"pay_shop-content-pay_amount"},[s("div",[s("span",[e._v("商品总额：")]),e._v(" "),s("span",[e._v("¥"+e._s(e.toFixedTwo(e.shopDrugSpecOrderDTO.amount)))])]),e._v(" "),s("div",[s("span",[e._v("医保扣除：")]),e._v(" "),s("span",[e._v("¥"+e._s(e.toFixedTwo(e.shopDrugSpecOrderDTO.medicaidAmount)))])]),e._v(" "),s("div",[s("span",[e._v("实际支付：")]),e._v(" "),s("span",[e._v("¥"+e._s(e.toFixedTwo(e.shopDrugSpecOrderDTO.payAmount)))])])]),e._v(" "),s("div",{staticClass:"dividing"}),e._v(" "),s("div",{staticClass:"pay_shop-content-medicaid"},[s("div",{staticClass:"pay_shop-content-medicaid-header"},[e._v("\n        医保信息\n      ")]),e._v(" "),s("div",{staticClass:"pay_shop-content-medicaid-content"},[e.isNotBlank(e.account.medicaidNumber)?s("div",{staticClass:"pay_shop-content-medicaid-content-card"},[s("div",[s("span",[e._v("会员姓名:")]),e._v(" "),s("span",[e._v(e._s(e.account.name))])]),e._v(" "),s("div",[s("span",[e._v("医保卡号:")]),e._v(" "),s("span",[e._v(e._s(e.account.medicaidNumber))])]),e._v(" "),e._m(4)]):s("div",{staticClass:"pay_shop-content-medicaid-content-no_card"},[s("span",{staticClass:"iconfont ic-qianbao"}),e._v(" "),s("a",{on:{click:e.linkToCardBind}},[e._v("去绑定医保卡")])])])])],1),e._v(" "),s("van-submit-bar",{ref:"footer",attrs:{price:100*e.payAmount,"button-text":"提交订单",loading:e.loading},on:{submit:e.onOrder}})],1)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pay_shop-content-delivery-address-left"},[t("i",{staticClass:"iconfont ic-dizhi"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pay_shop-content-delivery-address-right"},[t("i",{staticClass:"iconfont ic-youjiantou"})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pay_shop-content-delivery-bar"},[t("img",{attrs:{src:s("RugO")}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"pay_shop-content-delivery_type-header"},[t("div",[t("i",{staticClass:"iconfont ic-peisongfangshi"})]),this._v(" "),t("div",[this._v("配送方式")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("span",[this._v("卡内余额:")]),this._v(" "),t("span",[this._v("¥0")])])}]};var c=s("VU/8")(o,r,!1,function(e){s("JyoW")},"data-v-0a80606f",null);t.default=c.exports}});